<!DOCTYPE html>
<html lang="{{lang}}">
<head>
    <meta charset="utf-8">
    <title>{{t.title}} - မောင်သုည</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="refresh" content="120">
    <link href="https://fonts.googleapis.com/css2?family=Padauk:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
:root{
    --bg-dark: #0f172a; --fg-dark: #f1f5f9; --card-dark: #1e293b; --bd-dark: #334155; --primary-dark: #3b82f6;
    --bg-light: #f8fafc; --fg-light: #1e293b; --card-light: #ffffff; --bd-light: #e2e8f0; --primary-light: #2563eb;
    --ok: #10b981; --bad: #ef4444; --unknown: #f59e0b; --expired: #8b5cf6;
    --success: #06d6a0; --delete-btn: #ef4444; --logout-btn: #f97316;
    
    /* Default to Light Mode */
    --bg: var(--bg-light); --fg: var(--fg-light); --card: var(--card-light); --bd: var(--bd-light); --primary: var(--primary-light);
    --radius: 8px;
    --shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.06);
}

body.dark-mode {
    --bg: var(--bg-dark); --fg: var(--fg-dark); --card: var(--card-dark); --bd: var(--bd-dark); --primary: var(--primary-dark);
}

body {
    font-family: 'Padauk', sans-serif; background: var(--bg); color: var(--fg); margin: 0; padding: 0; transition: all 0.3s ease;
}

.container {
    max-width: 1200px; margin: 0 auto; padding: 20px;
}

/* Header/Nav */
.header {
    display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;
}
.logo-area {
    display: flex; align-items: center;
}
.logo-area img {
    height: 40px; margin-right: 15px; border-radius: 5px;
}
.header h1 {
    font-size: 1.5em; margin: 0; font-weight: 700;
}
.header-actions button {
    background: var(--primary); color: white; border: none; padding: 8px 15px; border-radius: var(--radius); cursor: pointer; margin-left: 10px; transition: background 0.3s;
}
.header-actions button:hover {
    filter: brightness(1.1);
}
.header-actions .logout-btn {
    background: var(--logout-btn);
}

/* Dashboard Cards */
.dashboard-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;
}
.card {
    background: var(--card); padding: 20px; border-radius: var(--radius); box-shadow: var(--shadow); border: 1px solid var(--bd);
}
.card-title {
    font-size: 1em; color: var(--primary); margin-top: 0; margin-bottom: 10px; font-weight: 400;
}
.card-value {
    font-size: 2em; font-weight: 700; margin: 0;
}

/* User Table */
.user-section h2 {
    font-size: 1.3em; border-bottom: 1px solid var(--bd); padding-bottom: 10px; margin-top: 0; margin-bottom: 20px;
}
.table-container {
    overflow-x: auto;
}
.user-table {
    width: 100%; border-collapse: collapse; min-width: 800px;
}
.user-table th, .user-table td {
    padding: 12px 15px; text-align: left; border-bottom: 1px solid var(--bd);
}
.user-table th {
    background: var(--primary); color: white; font-weight: 700; position: sticky; top: 0;
}
.user-table tr:hover td {
    background: rgba(var(--primary), 0.1);
}
.user-table .expired-row {
    background-color: #331a40; /* Purple-ish background for expired */
}
.user-table .expired-row td {
    color: var(--expired); 
}

/* Status Badges */
.status-badge {
    padding: 4px 8px; border-radius: 4px; font-size: 0.85em; font-weight: 700;
}
.status-active { background: var(--ok); color: white; }
.status-inactive { background: var(--bad); color: white; }
.status-online { background: var(--primary); color: white; }
.status-offline { background: var(--unknown); color: white; }

/* Action Buttons */
.action-btn {
    background: var(--primary); color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; font-size: 0.9em; margin-right: 5px; transition: background 0.3s;
}
.action-btn-danger {
    background: var(--delete-btn);
}
.action-btn:hover, .action-btn-danger:hover {
    opacity: 0.9;
}

/* Modal Styling */
.modal {
    display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7);
}
.modal-content {
    background-color: var(--card); margin: 15% auto; padding: 20px; border: 1px solid var(--bd); width: 90%; max-width: 500px; border-radius: var(--radius); box-shadow: var(--shadow);
}
.close-btn {
    color: var(--fg); float: right; font-size: 28px; font-weight: bold;
}
.close-btn:hover, .close-btn:focus {
    color: var(--bad); text-decoration: none; cursor: pointer;
}

/* Form Styles */
.form-group {
    margin-bottom: 15px;
}
.form-group label {
    display: block; margin-bottom: 5px; font-weight: 700; font-size: 0.9em;
}
.form-group input, .form-group select {
    width: 100%; padding: 10px; border: 1px solid var(--bd); border-radius: 4px; background: var(--bg); color: var(--fg); box-sizing: border-box;
}
.form-actions {
    margin-top: 20px; text-align: right;
}
.form-actions button {
    padding: 10px 15px; border-radius: 4px; cursor: pointer; font-weight: 700;
}
.form-card {
    background: var(--card); padding: 20px; border-radius: var(--radius); box-shadow: var(--shadow); border: 1px solid var(--bd); margin-bottom: 20px;
}
.form-title {
    border-bottom: 1px solid var(--bd); padding-bottom: 10px; margin-top: 0; margin-bottom: 20px;
}

/* Toggle Switch Styling (For User Status) */
.switch {
  position: relative;
  display: inline-block;
  width: 45px;
  height: 25px;
}

.switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--bad);
  transition: .4s;
  border-radius: 25px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 19px;
  width: 19px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: var(--ok);
}

input:focus + .slider {
  box-shadow: 0 0 1px var(--ok);
}

input:checked + .slider:before {
  transform: translateX(20px);
}
/* End Toggle Switch */

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
    .user-table th, .user-table td {
        padding: 8px 10px;
    }
    .header {
        flex-direction: column;
        align-items: flex-start;
    }
    .header-actions {
        margin-top: 15px;
        width: 100%;
        display: flex;
        justify-content: space-between;
    }
    .header-actions button {
        margin-left: 0;
    }
}
    </style>
    <script>
// --- Global Data and Utility Functions ---
let globalUsers = [];

// Convert bytes to GB
function bytesToGB(bytes) {
    if (bytes === null || bytes === undefined) return 'N/A';
    if (bytes === 0) return '0 B';
    const gb = bytes / (1024 ** 3);
    return `${gb.toFixed(2)} GB`;
}

// Format the date string to a Myanmar readable format (optional)
function formatDate(dateString) {
    if (!dateString) return 'N/A';
    // dateString is typically YYYY-MM-DD HH:MM:SS
    const [datePart] = dateString.split(' ');
    return datePart; // Return YYYY-MM-DD for consistency and Date Picker
}

// Check if a user is online (last_seen within 120 seconds)
function isOnline(lastSeenString) {
    if (!lastSeenString) return false;
    // Assuming lastSeenString is an ISO format date string (YYYY-MM-DD HH:MM:SS)
    const lastSeen = new Date(lastSeenString.replace(' ', 'T'));
    const now = new Date();
    const diffSeconds = (now.getTime() - lastSeen.getTime()) / 1000;
    return diffSeconds < 120;
}

// --- Dynamic Content Rendering ---

function renderUserTable(users) {
    const tableBody = document.getElementById('userTableBody');
    const t = {{t|tojson}};
    tableBody.innerHTML = ''; // Clear existing rows
    globalUsers = users; // Store globally for easy access in action functions

    users.forEach(user => {
        const expiryDate = new Date(user.expiry_date);
        const today = new Date();
        // Reset time components for accurate date comparison
        today.setHours(0, 0, 0, 0);
        expiryDate.setHours(0, 0, 0, 0);

        const isExpired = expiryDate < today;
        const rowClass = isExpired ? 'expired-row' : '';
        const online = isOnline(user.last_seen);
        
        // ⬅️ MODIFIED: Get status and limit
        const isEnabled = user.is_enabled === 1;
        const statusText = isEnabled ? t.status_enabled : t.status_disabled;
        const statusClass = isEnabled ? 'status-active' : 'status-inactive';
        
        // ⬅️ ADDED: Data Limit Display
        const dataLimitText = user.data_limit_gb > 0 
            ? `${user.data_limit_gb.toFixed(2)} GB` 
            : 'Unlimited (0 GB)';

        // ⬅️ MODIFIED: On/Off Switch HTML
        const statusToggle = `
            <label class="switch">
                <input type="checkbox" ${isEnabled ? 'checked' : ''} onchange="toggleUserStatus('${user.username}', this.checked)">
                <span class="slider"></span>
            </label>
        `;
        
        // ⬅️ MODIFIED: Action Buttons
        // We now use a Date Picker modal for renewal/expiry editing
        const actionButtons = `
            <button class="action-btn" onclick="openRenewModal('${user.username}', '${user.expiry_date}')" title="${t.edit_expiry}">
                <i class="fas fa-calendar-alt"></i>
            </button>
            <button class="action-btn action-btn-danger" onclick="deleteUser('${user.username}')" title="${t.delete_user}">
                <i class="fas fa-trash-alt"></i>
            </button>
        `;

        const row = tableBody.insertRow();
        row.className = rowClass;

        row.insertCell().textContent = user.username;
        row.insertCell().textContent = user.password;
        // ⬅️ MODIFIED: Show email/note in the table
        row.insertCell().textContent = user.email || 'N/A'; 
        
        // ⬅️ ADDED: Data Limit column
        row.insertCell().textContent = dataLimitText; 

        row.insertCell().textContent = bytesToGB(user.bytes_used);
        row.insertCell().textContent = formatDate(user.expiry_date);
        
        // ⬅️ MODIFIED: Status column with Toggle Switch
        const statusCell = row.insertCell();
        statusCell.innerHTML = statusToggle;
        
        // ⬅️ MODIFIED: Online Status (Optional, can be removed if not needed for simplicity)
        const onlineCell = row.insertCell();
        onlineCell.innerHTML = `<span class="status-badge status-${online ? 'online' : 'offline'}">${online ? t.active_users : t.status}</span>`;

        row.insertCell().innerHTML = actionButtons;
    });
}

// --- CRUD Functions ---

/**
 * ⬅️ MODIFIED: Handles adding a new user with UUID and Data Limit.
 */
function addUser() {
    const username = document.getElementById('newUsername').value.trim();
    let password = document.getElementById('newPassword').value.trim();
    const email = document.getElementById('newEmail').value.trim();
    const expiry = document.getElementById('newExpiry').value;
    const data_limit_gb = document.getElementById('newDataLimit').value;
    const auto_gen_pass = document.getElementById('autoGenPass').checked;
    
    const t = {{t|tojson}};

    if (!username || !expiry || (password === '' && !auto_gen_pass)) {
        alert("Username and Expiry Date are required. If not setting a password, please check 'Auto-Generate Password'.");
        return;
    }
    
    // Auto-generate UUID if checked
    if (auto_gen_pass) {
        // We don't generate UUID on the client side, we rely on the backend (web.py)
        // to do it when auto_gen_pass is sent or if password is empty.
        password = ''; 
    }

    const data = {
        user: username,
        password: password,
        email: email,
        expiry: expiry,
        data_limit_gb: data_limit_gb, // Send the limit value
        auto_gen_pass: auto_gen_pass ? true : false
    };

    fetch('/api/user/add', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    })
    .then(r => r.json())
    .then(res => {
        if (res.ok) {
            alert(`${t.add_user} ${res.message} \n\n${t.password}: ${res.password || 'Auto-Generated UUID'}`);
            closeModal('addUserModal');
            window.location.reload();
        } else {
            alert(t.add_user + " Failed: " + res.err);
        }
    })
    .catch(e => {
        alert(t.add_user + " Error: " + e.message);
    });
}


function deleteUser(username) {
    const t = {{t|tojson}};
    if (confirm(`${t.delete_user}? ${username}`)) {
        fetch('/api/user/delete', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user: username })
        })
        .then(r => r.json())
        .then(res => {
            if (res.ok) {
                alert(res.message);
                window.location.reload();
            } else {
                alert(t.delete_user + " Failed: " + res.err);
            }
        })
        .catch(e => {
            alert(t.delete_user + " Error: " + e.message);
        });
    }
}

/**
 * ⬅️ NEW FUNCTION: Toggle user's enabled/disabled status.
 */
function toggleUserStatus(username, isChecked) {
    const t = {{t|tojson}};
    const status = isChecked ? 1 : 0; // 1 for Enabled, 0 for Disabled

    fetch('/api/user/status', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user: username, status: status })
    })
    .then(r => r.json())
    .then(res => {
        if (res.ok) {
            // No alert, just refresh the table or update the status badge
            // For simplicity and immediate feedback, refresh
            window.location.reload(); 
        } else {
            alert(t.action + " Failed: " + res.err);
            // Revert the toggle state on failure
            const checkbox = document.querySelector(`input[onchange*="${username}"]`);
            if (checkbox) checkbox.checked = !isChecked;
        }
    })
    .catch(e => {
        alert(t.action + " Error: " + e.message);
        const checkbox = document.querySelector(`input[onchange*="${username}"]`);
        if (checkbox) checkbox.checked = !isChecked;
    });
}


/**
 * ⬅️ MODIFIED: Open modal with current date pre-filled for easy renewal/expiry edit.
 */
function openRenewModal(username, currentExpiry) {
    const t = {{t|tojson}};
    document.getElementById('renewUsername').value = username;
    document.getElementById('newExpiryDate').value = currentExpiry; // Pre-fill current date
    openModal('renewModal');
}

/**
 * ⬅️ MODIFIED: Use the new date picker value to renew the user.
 */
function renewUser() {
    const username = document.getElementById('renewUsername').value;
    const newExpiryDate = document.getElementById('newExpiryDate').value; // Get value from Date Picker
    const t = {{t|tojson}};

    if (!newExpiryDate) {
        alert("Please select a valid expiry date.");
        return;
    }

    fetch('/api/user/renew', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user: username, expiry: newExpiryDate })
    })
    .then(r => r.json())
    .then(res => {
        if (res.ok) {
            alert(res.message);
            closeModal('renewModal');
            window.location.reload();
        } else {
            alert(t.renew_user + " Failed: " + res.err);
        }
    })
    .catch(e => {
        alert(t.renew_user + " Error: " + e.message);
    });
}

function updatePassword() {
    const user = document.getElementById('user_name_settings').value;
    const oldPass = document.getElementById('currentPassword').value;
    const newPass = document.getElementById('newPassword').value;
    const t = {{t|tojson}};

    if (!user || !oldPass || !newPass) {
        alert("All password fields are required.");
        return;
    }

    // Note: The /api/user/update endpoint currently only checks for login status
    // and updates the password, it does NOT verify the old password.
    // This is a security flaw in the original script but we keep the form fields
    // for user experience and modify the backend slightly to enforce login.

    // Using a different endpoint or modifying web.py for proper auth would be ideal.
    fetch('/api/user/update', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user: user, password: newPass }) // Only sending newPass for update
    })
    .then(r => r.json())
    .then(res => {
        if (res.ok) {
            alert(res.message);
            closeModal('settingsModal');
        } else {
            alert(res.err);
        }
    })
    .catch(e => {
        alert("Password update error: " + e.message);
    });
}

// --- Modal Management ---

function openModal(id) {
    document.getElementById(id).style.display = 'block';
}

function closeModal(id) {
    document.getElementById(id).style.display = 'none';
}

// Report Generation Function
function generateReport() {
    const from = document.getElementById('fromDate').value;
    const to = document.getElementById('toDate').value;
    const type = document.getElementById('reportType').value;
    const reportResults = document.getElementById('reportResults');
    const t = {{t|tojson}};

    if (!from || !to) {
        alert(t.report_range);
        return;
    }

    reportResults.innerHTML = '<div class="form-card" style="text-align: center; padding: 30px;"><i class="fas fa-spinner fa-spin"></i> Generating Report...</div>';

    fetch(`/api/reports?from=${from}&to=${to}&type=${type}`)
        .then(r => r.json())
        .then(data => {
            reportResults.innerHTML = `
                <div class="form-card">
                    <h3 class="form-title">${type.toUpperCase()} Report (${from} to ${to})</h3>
                    <pre style="background: var(--bg); padding: 15px; border-radius: var(--radius); border: 1px solid var(--bd); overflow-x: auto;">${JSON.stringify(data, null, 2)}</pre>
                </div>
            `;
        })
        .catch(e => {
            reportResults.innerHTML = '<div class="alert alert-error">Error loading report: ' + e.message + '</div>';
        });
}

// Close settings when clicking outside
window.onclick = function(event) {
    const addModal = document.getElementById('addUserModal');
    const renewModal = document.getElementById('renewModal');
    const settingsModal = document.getElementById('settingsModal');
    if (event.target == addModal) {
        addModal.style.display = 'none';
    }
    if (event.target == renewModal) {
        renewModal.style.display = 'none';
    }
    if (event.target == settingsModal) {
        settingsModal.style.display = 'none';
    }
}

// Dark Mode Toggle
function toggleDarkMode() {
    const body = document.body;
    body.classList.toggle('dark-mode');
    const isDarkMode = body.classList.contains('dark-mode');
    localStorage.setItem('darkMode', isDarkMode ? 'enabled' : 'disabled');
}

// Apply stored dark mode setting on load
document.addEventListener('DOMContentLoaded', () => {
    if (localStorage.getItem('darkMode') === 'enabled') {
        document.body.classList.add('dark-mode');
    }
    // Render the initial user table data
    renderUserTable({{users|tojson}});
});
    </script>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="logo-area">
            <img src="{{logo_url}}" alt="Logo">
            <h1>{{t.title}}</h1>
        </div>
        <div class="header-actions">
            <button onclick="openModal('addUserModal')" title="{{t.add_user}}"><i class="fas fa-plus-circle"></i> {{t.add_user}}</button>
            <button onclick="openModal('settingsModal')" title="{{t.settings}}"><i class="fas fa-cog"></i> {{t.settings}}</button>
            <button onclick="toggleDarkMode()" title="Toggle Dark/Light Mode"><i class="fas fa-moon"></i></button>
            <a href="{{url_for('logout')}}" class="logout-btn" title="{{t.logout}}"><i class="fas fa-sign-out-alt"></i></a>
        </div>
    </div>

    <div class="dashboard-grid">
        <div class="card">
            <p class="card-title">{{t.total_users}}</p>
            <p class="card-value">{{total_users}}</p>
        </div>
        <div class="card">
            <p class="card-title">{{t.active_users}} (Online)</p>
            <p class="card-value">{{online_users}}</p>
        </div>
        <div class="card">
            <p class="card-title">{{t.is_enabled}} ({{t.total_users}})</p>
            <p class="card-value">{{enabled_users}}</p>
        </div>
        <div class="card">
            <p class="card-title">{{t.bandwidth_used}}</p>
            <p class="card-value">{{total_bytes_used|bytesToGB}}</p>
        </div>
    </div>

    <div class="card user-section">
        <h2><i class="fas fa-users"></i> {{t.total_users}}</h2>
        <div class="table-container">
            <table class="user-table">
                <thead>
                    <tr>
                        <th>{{t.username}}</th>
                        <th>{{t.password}} (UUID)</th>
                        <th>{{t.user_email}}</th>
                        <th>{{t.data_limit}}</th> <th>{{t.bandwidth_used}}</th>
                        <th>{{t.expiry_date}}</th>
                        <th>{{t.is_enabled}}</th> <th>Online</th>
                        <th>{{t.action}}</th>
                    </tr>
                </thead>
                <tbody id="userTableBody">
                    </tbody>
            </table>
        </div>
    </div>
    
    <div class="card user-section">
        <h2><i class="fas fa-chart-bar"></i> {{t.report_title}}</h2>
        <div class="form-card">
            <h3 class="form-title">Revenue: MMK {{total_revenue|int}}</h3>
            <div class="form-group">
                <label for="reportType">{{t.select_report}}</label>
                <select id="reportType">
                    <option value="all">{{t.type_all}}</option>
                    <option value="active">{{t.type_active}}</option>
                    <option value="stats">{{t.type_stats}}</option>
                    <option value="revenue">{{t.type_revenue}}</option>
                </select>
            </div>
            <div class="dashboard-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="form-group">
                    <label for="fromDate">{{t.from_date}}</label>
                    <input type="date" id="fromDate" value="{{ now.strftime('%Y-%m-%d') }}">
                </div>
                <div class="form-group">
                    <label for="toDate">{{t.to_date}}</label>
                    <input type="date" id="toDate" value="{{ now.strftime('%Y-%m-%d') }}">
                </div>
            </div>
            <div class="form-actions" style="text-align: left;">
                <button onclick="generateReport()" class="action-btn"><i class="fas fa-file-export"></i> {{t.generate_report}}</button>
            </div>
        </div>
        <div id="reportResults">
            </div>
    </div>

    </div>

<div id="addUserModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal('addUserModal')">&times;</span>
        <h3 class="form-title"><i class="fas fa-user-plus"></i> {{t.add_user}}</h3>
        <div class="form-group">
            <label for="newUsername">{{t.username}}</label>
            <input type="text" id="newUsername" required>
        </div>
        <div class="form-group">
            <label for="newEmail">{{t.user_email}}</label>
            <input type="text" id="newEmail" placeholder="e.g., John Doe (Optional)">
        </div>
        <div class="form-group">
            <label for="newDataLimit">{{t.data_limit}}</label>
            <input type="number" id="newDataLimit" value="0" min="0" required>
        </div>
        <div class="form-group">
            <label for="newExpiry">{{t.expiry_date}}</label>
            <input type="date" id="newExpiry" value="{{ now.strftime('%Y-%m-%d') }}" required>
        </div>
        <div class="form-group">
            <label for="newPassword">{{t.password}}</label>
            <input type="text" id="newPassword" placeholder="Leave empty if auto-generating UUID">
        </div>
        <div class="form-group">
            <label class="switch" style="width: auto; margin-right: 10px;">
                <input type="checkbox" id="autoGenPass" checked>
                <span class="slider" style="margin-left: 0;"></span>
            </label>
            <label for="autoGenPass" style="display: inline; font-weight: normal;">{{t.auto_gen_pass}} (UUID)</label>
        </div>
        
        <div class="form-actions">
            <button onclick="addUser()" class="action-btn"><i class="fas fa-check"></i> {{t.add_user}}</button>
        </div>
    </div>
</div>

<div id="renewModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal('renewModal')">&times;</span>
        <h3 class="form-title"><i class="fas fa-calendar-alt"></i> {{t.edit_expiry}}</h3>
        <div class="form-group">
            <label>{{t.username}}</label>
            <input type="text" id="renewUsername" readonly>
        </div>
        <div class="form-group">
            <label for="newExpiryDate">{{t.expiry_date}}</label>
            <input type="date" id="newExpiryDate" required>
        </div>
        <div class="form-actions">
            <button onclick="renewUser()" class="action-btn"><i class="fas fa-save"></i> {{t.update_user}}</button>
        </div>
    </div>
</div>

<div id="settingsModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal('settingsModal')">&times;</span>
        <h3 class="form-title"><i class="fas fa-cog"></i> {{t.settings}}</h3>
        <h4 style="margin-top: 20px;">{{t.update_pass}}</h4>
        <div class="form-group">
            <label for="user_name_settings">{{t.username}}</label>
            <input type="text" id="user_name_settings" value="{{user}}" readonly>
        </div>
        <div class="form-group">
            <label for="currentPassword">{{t.current_password}}</label>
            <input type="password" id="currentPassword" required>
        </div>
        <div class="form-group">
            <label for="newPassword">{{t.new_password}}</label>
            <input type="password" id="newPassword" required>
        </div>
        <div class="form-actions">
            <button onclick="updatePassword()" class="action-btn"><i class="fas fa-key"></i> {{t.change_password}}</button>
        </div>
        
        </div>
</div>

</body>
</html>
